<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1a365d">
    <title>Configurador de Óculos - Standalone</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f1419 0%, #1a202c 25%, #2d3748 50%, #1a365d 75%, #2c5aa0 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: white;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at top, rgba(49, 130, 206, 0.1) 0%, transparent 70%),
                        radial-gradient(ellipse at bottom, rgba(99, 179, 237, 0.1) 0%, transparent 70%);
            pointer-events: none;
            z-index: -1;
        }
        
        .container { 
            max-width: 500px; 
            margin: 0 auto; 
            position: relative;
            z-index: 1;
        }
        
        .card { 
            background: linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
            border-radius: 20px; 
            padding: 30px; 
            margin: 25px 0;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 
                0 25px 50px rgba(0,0,0,0.4),
                0 10px 30px rgba(49, 130, 206, 0.2),
                inset 0 1px 0 rgba(255,255,255,0.3),
                inset 0 -1px 0 rgba(0,0,0,0.2);
            position: relative;
            transform-style: preserve-3d;
            transition: all 0.3s ease;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
            border-radius: 20px;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        
        .card:hover {
            transform: translateY(-8px) rotateX(2deg);
            box-shadow: 
                0 35px 70px rgba(0,0,0,0.5),
                0 15px 40px rgba(49, 130, 206, 0.3),
                inset 0 1px 0 rgba(255,255,255,0.4),
                inset 0 -1px 0 rgba(0,0,0,0.3);
        }
        
        .card:hover::before {
            opacity: 1;
        }
        
        .btn { 
            background: linear-gradient(145deg, #3182ce, #2c5aa0, #1e4a72);
            color: white; 
            border: none; 
            padding: 18px 30px; 
            border-radius: 15px; 
            cursor: pointer; 
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            margin: 12px 0;
            box-shadow: 
                0 8px 25px rgba(49, 130, 206, 0.4),
                0 4px 10px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.2),
                inset 0 -1px 0 rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            transform-style: preserve-3d;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .btn:hover { 
            background: linear-gradient(145deg, #2c5aa0, #1e4a72, #1a4168);
            transform: translateY(-3px) rotateX(5deg);
            box-shadow: 
                0 12px 35px rgba(49, 130, 206, 0.5),
                0 6px 15px rgba(0,0,0,0.4),
                inset 0 1px 0 rgba(255,255,255,0.3),
                inset 0 -1px 0 rgba(0,0,0,0.3);
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:active {
            transform: translateY(-1px) rotateX(2deg);
        }
        
        .btn-outline {
            background: linear-gradient(145deg, transparent, rgba(49, 130, 206, 0.1));
            border: 2px solid #3182ce;
            color: #63b3ed;
            box-shadow: 
                0 8px 25px rgba(49, 130, 206, 0.2),
                0 4px 10px rgba(0,0,0,0.2),
                inset 0 1px 0 rgba(255,255,255,0.1);
        }
        
        .btn-outline:hover {
            background: linear-gradient(145deg, #3182ce, rgba(49, 130, 206, 0.8));
            color: white;
            border-color: #63b3ed;
        }
        
        .hidden { display: none; }
        
        .progress-bar {
            background: linear-gradient(145deg, rgba(255,255,255,0.1), rgba(0,0,0,0.2));
            height: 12px;
            border-radius: 15px;
            overflow: hidden;
            margin: 25px 0;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #3182ce, #63b3ed, #7dd3fc);
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 15px;
            box-shadow: 0 2px 8px rgba(49, 130, 206, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .lens-card {
            background: linear-gradient(145deg, rgba(255,255,255,0.12), rgba(255,255,255,0.04));
            border-radius: 18px;
            padding: 20px;
            margin: 15px 0;
            border-left: 5px solid #3182ce;
            box-shadow: 
                0 15px 35px rgba(0,0,0,0.3),
                0 5px 15px rgba(49, 130, 206, 0.2),
                inset 0 1px 0 rgba(255,255,255,0.2);
            position: relative;
            transition: all 0.3s ease;
            transform-style: preserve-3d;
        }
        
        .lens-card:hover {
            transform: translateY(-5px) rotateX(3deg);
            box-shadow: 
                0 20px 45px rgba(0,0,0,0.4),
                0 8px 20px rgba(49, 130, 206, 0.3),
                inset 0 1px 0 rgba(255,255,255,0.3);
        }
        
        .price { 
            font-size: 22px; 
            font-weight: 700; 
            color: #63b3ed; 
            margin: 10px 0;
            text-shadow: 0 2px 8px rgba(99, 179, 237, 0.5);
        }
        
        .features {
            display: flex;
            gap: 8px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .feature {
            background: linear-gradient(145deg, rgba(49, 130, 206, 0.3), rgba(49, 130, 206, 0.1));
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            border: 1px solid rgba(49, 130, 206, 0.3);
            box-shadow: 
                0 4px 12px rgba(49, 130, 206, 0.2),
                inset 0 1px 0 rgba(255,255,255,0.2);
            transition: all 0.2s ease;
        }
        
        .feature:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 6px 16px rgba(49, 130, 206, 0.3),
                inset 0 1px 0 rgba(255,255,255,0.3);
        }
        
        .editor-input {
            width: 100%;
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.3);
            background: linear-gradient(145deg, rgba(255,255,255,0.12), rgba(255,255,255,0.06));
            color: white;
            margin: 8px 0;
            font-size: 14px;
            box-shadow: 
                inset 0 2px 4px rgba(0,0,0,0.2),
                0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .editor-input:focus {
            outline: none;
            border-color: #63b3ed;
            box-shadow: 
                inset 0 2px 4px rgba(0,0,0,0.2),
                0 0 0 3px rgba(99, 179, 237, 0.2),
                0 4px 12px rgba(99, 179, 237, 0.3);
        }
        
        .editor-input::placeholder { 
            color: rgba(255,255,255,0.5); 
        }
        
        select.editor-input option {
            background: #1a365d;
            color: white;
        }
        
        textarea.editor-input {
            resize: vertical;
            min-height: 60px;
        }
        
        h1 {
            text-shadow: 
                0 4px 8px rgba(0,0,0,0.3),
                0 8px 16px rgba(49, 130, 206, 0.2);
            background: linear-gradient(135deg, #63b3ed, #3182ce, #1e4a72);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        h2, h3 {
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        /* Efeito de brilho animado para elementos importantes */
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(99, 179, 237, 0.3); }
            50% { box-shadow: 0 0 30px rgba(99, 179, 237, 0.5); }
        }
        
        .price {
            animation: glow 3s ease-in-out infinite;
        }
        
        /* Partículas flutuantes de fundo */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(99, 179, 237, 0.1) 1px, transparent 1px),
                radial-gradient(circle at 80% 70%, rgba(49, 130, 206, 0.1) 1px, transparent 1px),
                radial-gradient(circle at 60% 20%, rgba(99, 179, 237, 0.05) 1px, transparent 1px);
            background-size: 200px 200px, 300px 300px, 250px 250px;
            animation: float 20s linear infinite;
            pointer-events: none;
            z-index: -1;
        }
        
        @keyframes float {
            0% { transform: translateY(0px) translateX(0px); }
            33% { transform: translateY(-20px) translateX(10px); }
            66% { transform: translateY(10px) translateX(-5px); }
            100% { transform: translateY(0px) translateX(0px); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Tela Inicial -->
        <div id="welcome-screen" class="card">
            <h1 style="text-align: center; font-size: 28px; margin-bottom: 20px;">👓 Configurador de Óculos</h1>
            <p style="text-align: center; margin-bottom: 30px; opacity: 0.8;">
                Encontre a lente perfeita através de algumas perguntas simples
            </p>
            <button class="btn" onclick="startQuestions()">Começar Configuração</button>
            <button class="btn-outline btn" onclick="showAllLenses()">Ver Todas as Lentes</button>
            <button class="btn-outline btn" onclick="showEditor()">Editar Preços</button>
            <button class="btn-outline btn" onclick="downloadStandalone()">Baixar App Offline</button>
        </div>

        <!-- Tela de Perguntas -->
        <div id="question-screen" class="card hidden">
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
            </div>
            <h2 id="question-text" style="text-align: center; margin-bottom: 30px;"></h2>
            <div id="question-options"></div>
            <button class="btn-outline btn" onclick="goBack()" style="margin-top: 20px;">← Voltar</button>
        </div>

        <!-- Tela de Resultados -->
        <div id="results-screen" class="card hidden">
            <h2 style="text-align: center; margin-bottom: 20px;">Lentes Encontradas</h2>
            <div id="results-list"></div>
            <button class="btn-outline btn" onclick="startOver()">Nova Busca</button>
        </div>

        <!-- Editor de Preços -->
        <div id="editor-screen" class="card hidden">
            <h2 style="margin-bottom: 20px;">Editor de Preços</h2>
            <div id="lens-list"></div>
            <button class="btn" onclick="addNewLens()">Adicionar Nova Lente</button>
            <button class="btn-outline btn" onclick="backToWelcome()">Voltar</button>
        </div>
    </div>

    <script>
        // Todas as 43 lentes da planilha PRECIFICAÇÃO_REAL com tipo de visão
        let lensData = [
            {id: 1, nome: "LT CR-39", incolor: false, antireflexo: true, fotosensivel: false, blueCut: false, tipo: "VISÃO SIMPLES", tipo: "VISÃO SIMPLES", medidas: "Esf. -6,00 a +4,00 / Cil. -0,25 a -2,00", espessura: "1.56", precoVista: "R$ 399,00", parcela3x: "R$ 159,60", parcela6x: "R$ 89,77", parcela10x: "R$ 65,84"},
            {id: 2, nome: "LT CR-39", incolor: false, antireflexo: true, fotosensivel: false, blueCut: false, tipo: "VISÃO SIMPLES", tipo: "VISÃO SIMPLES", medidas: "Esf. -6,00 a +6,00 / Cil. -2,25 a -4,00", espessura: "1.56", precoVista: "R$ 499,00", parcela3x: "R$ 199,60", parcela6x: "R$ 112,27", parcela10x: "R$ 82,34"},
            {id: 3, nome: "LT CR-39", incolor: false, antireflexo: true, fotosensivel: false, blueCut: false, tipo: "VISÃO SIMPLES", tipo: "VISÃO SIMPLES", medidas: "Esf. -4,00 a +4,00 / Cil. -4,25 a -6,00", espessura: "1.56", precoVista: "R$ 599,00", parcela3x: "R$ 239,60", parcela6x: "R$ 134,78", parcela10x: "R$ 98,84"},
            {id: 4, nome: "LT CR-39", incolor: false, antireflexo: true, fotosensivel: true, blueCut: false, tipo: "VISÃO SIMPLES", tipo: "VISÃO SIMPLES", medidas: "Esf. -4,00 a +4,00 / Cil. -0,25 a -2,00", espessura: "1.56", precoVista: "R$ 499,00", parcela3x: "R$ 199,60", parcela6x: "R$ 112,27", parcela10x: "R$ 82,34"},
            {id: 5, nome: "LT CR-39", incolor: false, antireflexo: true, fotosensivel: true, blueCut: false, tipo: "VISÃO SIMPLES", tipo: "VISÃO SIMPLES", medidas: "Esf. -4,00 a +4,00 / Cil. -2,25 a -4,00", espessura: "1.56", precoVista: "R$ 599,00", parcela3x: "R$ 239,60", parcela6x: "R$ 134,78", parcela10x: "R$ 98,84"},
            {id: 6, nome: "LT CR-39", incolor: false, antireflexo: true, fotosensivel: false, blueCut: true, tipo: "VISÃO SIMPLES", tipo: "VISÃO SIMPLES", medidas: "Esf. -6,00 a +4,00 / Cil. -0,25 a -2,00", espessura: "1.56", precoVista: "R$ 499,00", parcela3x: "R$ 199,60", parcela6x: "R$ 112,27", parcela10x: "R$ 82,34"},
            {id: 7, nome: "LT CR-39", incolor: false, antireflexo: true, fotosensivel: false, blueCut: true, tipo: "VISÃO SIMPLES", tipo: "VISÃO SIMPLES", medidas: "Esf. -4,00 a +4,00 / Cil. -2,25 a -4,00", espessura: "1.56", precoVista: "R$ 599,00", parcela3x: "R$ 239,60", parcela6x: "R$ 134,78", parcela10x: "R$ 98,84"},
            {id: 8, nome: "LT CR-39", incolor: false, antireflexo: true, fotosensivel: true, blueCut: true, tipo: "VISÃO SIMPLES", tipo: "VISÃO SIMPLES", medidas: "Esf. -4,00 a +2,00 / Cil. -0,25 a -2,00", espessura: "1.56", precoVista: "R$ 699,00", parcela3x: "R$ 279,60", parcela6x: "R$ 157,28", parcela10x: "R$ 115,33"},
            {id: 9, nome: "LT CR-39", incolor: false, antireflexo: true, fotosensivel: true, blueCut: true, tipo: "VISÃO SIMPLES", tipo: "VISÃO SIMPLES", medidas: "Esf. -4,00 a +2,00 / Cil. -2,25 a -4,00", espessura: "1.56", precoVista: "R$ 799,00", parcela3x: "R$ 319,60", parcela6x: "R$ 179,78", parcela10x: "R$ 131,83"},
            {id: 10, nome: "LT POLI", incolor: true, antireflexo: false, fotosensivel: false, blueCut: false, tipo: "VISÃO SIMPLES", medidas: "Esf. -4,00 a +4,00 / Cil. -0,25 a -2,00", espessura: "1.59", precoVista: "R$ 499,00", parcela3x: "R$ 199,60", parcela6x: "R$ 112,27", parcela10x: "R$ 82,34"},
            {id: 11, nome: "LT POLI", incolor: false, antireflexo: true, fotosensivel: false, blueCut: false, tipo: "VISÃO SIMPLES", medidas: "Esf. -5,00 a +4,00 / Cil. -0,25 a -2,00", espessura: "1.59", precoVista: "R$ 599,00", parcela3x: "R$ 239,60", parcela6x: "R$ 134,78", parcela10x: "R$ 98,84"},
            {id: 12, nome: "LT POLI", incolor: false, antireflexo: true, fotosensivel: false, blueCut: false, tipo: "VISÃO SIMPLES", medidas: "Esf. -2,00 a +3,00 / Cil. -2,25 a -4,00", espessura: "1.59", precoVista: "R$ 599,00", parcela3x: "R$ 239,60", parcela6x: "R$ 134,78", parcela10x: "R$ 98,84"},
            {id: 13, nome: "LT POLI HAYTEK", incolor: false, antireflexo: true, fotosensivel: true, blueCut: false, tipo: "VISÃO SIMPLES", medidas: "Esf. -4,00 a +2,00 / Cil. -0,25 a -2,00", espessura: "1.59", precoVista: "R$ 799,00", parcela3x: "R$ 319,60", parcela6x: "R$ 179,78", parcela10x: "R$ 131,83"},
            {id: 14, nome: "LT POLI HAYTEK", incolor: false, antireflexo: true, fotosensivel: true, blueCut: false, tipo: "VISÃO SIMPLES", medidas: "Esf. -4,00 a +2,00 / Cil. -2,25 a -4,00", espessura: "1.59", precoVista: "R$ 899,00", parcela3x: "R$ 359,60", parcela6x: "R$ 202,28", parcela10x: "R$ 148,33"},
            {id: 15, nome: "LT POLI", incolor: false, antireflexo: true, fotosensivel: false, blueCut: true, tipo: "VISÃO SIMPLES", medidas: "Esf. -6,00 a +4,00 / Cil. -0,25 a -2,00", espessura: "1.59", precoVista: "R$ 899,00", parcela3x: "R$ 359,60", parcela6x: "R$ 202,28", parcela10x: "R$ 148,33"},
            {id: 16, nome: "LT POLI", incolor: false, antireflexo: true, fotosensivel: false, blueCut: true, tipo: "VISÃO SIMPLES", medidas: "Esf. -6,00 a +4,00 / Cil. -2,25 a -4,00", espessura: "1.59", precoVista: "R$ 999,00", parcela3x: "R$ 399,60", parcela6x: "R$ 224,78", parcela10x: "R$ 164,83"},
            {id: 17, nome: "LT TRANSITIONS", incolor: false, antireflexo: true, fotosensivel: false, blueCut: false, tipo: "VISÃO SIMPLES", medidas: "Esf. -2,00 a +2,00 / Cil. -0,25 a -2,00", espessura: "1.50", precoVista: "R$ 899,00", parcela3x: "R$ 359,60", parcela6x: "R$ 202,28", parcela10x: "R$ 148,33"},
            {id: 18, nome: "LT ALTO INDICE ~ SHINEDUX", incolor: false, antireflexo: true, fotosensivel: false, blueCut: true, tipo: "VISÃO SIMPLES", medidas: "Esf. -10,00 a +7,00 / Esf. -6,00 a +6,00 / Cil. -4,00 Esf. -6,25 a -10,00 / Cil. -2,00", espessura: "1.61", precoVista: "R$ 999,00", parcela3x: "R$ 399,60", parcela6x: "R$ 224,78", parcela10x: "R$ 164,83"},
            {id: 19, nome: "LT ALTO INDICE - SHINEDUX", incolor: false, antireflexo: true, fotosensivel: false, blueCut: false, tipo: "VISÃO SIMPLES", medidas: "Esf. -10,00 a +7,00 / Esf. -6,00 a +6,00 / Cil. -4,00 Esf. -6,25 a -10,00 / Cil. -2,00", espessura: "1.61", precoVista: "R$ 899,00", parcela3x: "R$ 359,60", parcela6x: "R$ 202,28", parcela10x: "R$ 148,33"},
            {id: 20, nome: "LT ALTO INDICE - SHINEDUX", incolor: false, antireflexo: true, fotosensivel: false, blueCut: false, tipo: "VISÃO SIMPLES", medidas: "Esf. -3,00 a -15,00 / Esf. -3,00 a -10,00 / Cil. -4,00 Esf. -10,25 a -12,00 / Cil. -2,00", espessura: "1.67", precoVista: "R$ 1199,00", parcela3x: "R$ 479,60", parcela6x: "R$ 269,78", parcela10x: "R$ 197,83"},
            {id: 21, nome: "LT ALTO INDICE - SHINEDUX", incolor: false, antireflexo: true, fotosensivel: true, blueCut: true, tipo: "VISÃO SIMPLES", medidas: "Esf. -3,00 a -15,00 / Esf. -3,00 a -10,00 / Cil. -4,00 Esf. -10,25 a -12,00 / Cil. -2,00", espessura: "1.67", precoVista: "R$ 1399,00", parcela3x: "R$ 559,60", parcela6x: "R$ 314,78", parcela10x: "R$ 230,83"},
            {id: 22, nome: "LT ALTO INDICE", incolor: false, antireflexo: true, fotosensivel: true, blueCut: false, tipo: "VISÃO SIMPLES", medidas: "Esf. -10,00 a +6,00 / Esf. -8,00 a +6,00 / Cil. -4,00 Esf. -8,25 a -10,00 / Cil. -3,00", espessura: "1.67", precoVista: "R$ 1299,00", parcela3x: "R$ 519,60", parcela6x: "R$ 292,28", parcela10x: "R$ 214,33"},
            {id: 23, nome: "LT ALTO INDICE RESIDUAL VERDE", incolor: false, antireflexo: false, fotosensivel: false, blueCut: true, tipo: "VISÃO SIMPLES", medidas: "Esf. -10,00 a +6,00 / Cil. -0,25 a -4,00", espessura: "1.67", precoVista: "R$ 1299,00", parcela3x: "R$ 519,60", parcela6x: "R$ 292,28", parcela10x: "R$ 214,33"},
            {id: 24, nome: "LT ALTO INDICE RESIDUAL VERDE", incolor: false, antireflexo: false, fotosensivel: false, blueCut: true, tipo: "VISÃO SIMPLES", medidas: "Esf. -1,00 a -15,00 / Cil. -0,25 a -3,00", espessura: "1.74", precoVista: "R$ 1899,00", parcela3x: "R$ 759,60", parcela6x: "R$ 427,28", parcela10x: "R$ 313,34"},
            {id: 25, nome: "LT ULTRAX TRIVEX - HOYA", incolor: false, antireflexo: true, fotosensivel: false, blueCut: false, tipo: "VISÃO SIMPLES", medidas: "Esf. -4,00 a +3,00 / Cil. -0,25 a -2,00", espessura: "1.53", precoVista: "R$ 999,00", parcela3x: "R$ 399,60", parcela6x: "R$ 224,78", parcela10x: "R$ 164,83"},
            {id: 26, nome: "LT ULTRAX TRIVEX TRANSITIONS - HOYA", incolor: false, antireflexo: true, fotosensivel: false, blueCut: false, tipo: "VISÃO SIMPLES", medidas: "Esf. -4,00 a +3,00 / Cil. -0,25 a -2,00", espessura: "1.53", precoVista: "R$ 1299,00", parcela3x: "R$ 519,60", parcela6x: "R$ 292,28", parcela10x: "R$ 214,33"},
            {id: 27, nome: "LT CR-39 - MARRON / CINZA / BLACK / G-15", incolor: true, antireflexo: false, fotosensivel: false, blueCut: false, tipo: "LENTES SOLARES", medidas: "CURVA 600", espessura: "70mm", precoVista: "R$ 199,00", parcela3x: "R$ 79,60", parcela6x: "R$ 44,77", parcela10x: "R$ 32,84"},
            {id: 28, nome: "LT CR-39 ~ DEGRADE - MARRON / CINZA / BLACK / G-15", incolor: true, antireflexo: false, fotosensivel: false, blueCut: false, tipo: "LENTES SOLARES", medidas: "CURVA 600", espessura: "70mm", precoVista: "R$ 199,00", parcela3x: "R$ 79,60", parcela6x: "R$ 44,77", parcela10x: "R$ 32,84"},
            {id: 29, nome: "LT CR-39 - CINZA / MARRON /G-15", incolor: true, antireflexo: false, fotosensivel: false, blueCut: false, tipo: "LENTES SOLARES", medidas: "CURVA 800", espessura: "70mm", precoVista: "R$ 199,00", parcela3x: "R$ 79,60", parcela6x: "R$ 44,77", parcela10x: "R$ 32,84"},
            {id: 30, nome: "LT POLARIZADA - CINZA / MARRON / G-15", incolor: true, antireflexo: false, fotosensivel: false, blueCut: false, tipo: "LENTES SOLARES", medidas: "CURVA 600", espessura: "70mm", precoVista: "R$ 199,00", parcela3x: "R$ 79,60", parcela6x: "R$ 44,77", parcela10x: "R$ 32,84"},
            {id: 31, nome: "LT ESPELHADA - AZUL / VERMELHA / PRATA / GOLD", incolor: true, antireflexo: false, fotosensivel: false, blueCut: false, tipo: "LENTES SOLARES", medidas: "CURVA 600", espessura: "70mm", precoVista: "R$ 399,00", parcela3x: "R$ 159,60", parcela6x: "R$ 89,77", parcela10x: "R$ 65,84"},
            {id: 32, nome: "LT POLI - MARRON / CINZA /G-15", incolor: true, antireflexo: false, fotosensivel: false, blueCut: false, tipo: "LENTES SOLARES", medidas: "CURVA 600 / 800", espessura: "70mm", precoVista: "R$ 199,00", parcela3x: "R$ 79,60", parcela6x: "R$ 44,77", parcela10x: "R$ 32,84"},
            {id: 33, nome: "LT POLI - DEGRADE / CINZA / MARRON", incolor: true, antireflexo: false, fotosensivel: false, blueCut: false, tipo: "LENTES SOLARES", medidas: "CURVA 600", espessura: "70mm", precoVista: "R$ 199,00", parcela3x: "R$ 79,60", parcela6x: "R$ 44,77", parcela10x: "R$ 32,84"},
            {id: 34, nome: "LT CRISTAL - G-15", incolor: true, antireflexo: false, fotosensivel: false, blueCut: false, tipo: "LENTES SOLARES", medidas: "CURVA 600", espessura: "70mm", precoVista: "R$ 299,00", parcela3x: "R$ 119,60", parcela6x: "R$ 67,27", parcela10x: "R$ 49,34"},
            {id: 35, nome: "BF ULTEX / KRIPTOK ACABADO", incolor: true, antireflexo: false, fotosensivel: false, blueCut: false, tipo: "BIFOCAIS CR-39", medidas: "ESF. 0,00/3,00 - AD: 1,00 a 3,00", espessura: "15mm", precoVista: "R$ 599,00", parcela3x: "R$ 239,60", parcela6x: "R$ 134,78", parcela10x: "R$ 98,84"},
            {id: 36, nome: "MF CR-39 - SHINEDUX", incolor: true, antireflexo: false, fotosensivel: false, blueCut: false, tipo: "PROGRESSIVAS ACABADAS", medidas: "ESF. 0,00/2,00 - AD: 1,00 a 3,00", espessura: "18mm", precoVista: "R$ 599,00", parcela3x: "R$ 239,60", parcela6x: "R$ 134,78", parcela10x: "R$ 98,84"},
            {id: 37, nome: "MF CR-39 ~ FREE LINE / PRO LIFE", incolor: true, antireflexo: false, fotosensivel: false, blueCut: false, tipo: "PROGRESSIVAS ACABADAS", medidas: "ESF. 0,00/2,00 - AD: 1,00 a 3,00", espessura: "18mm", precoVista: "R$ 599,00", parcela3x: "R$ 239,60", parcela6x: "R$ 134,78", parcela10x: "R$ 98,84"},
            {id: 38, nome: "MF CR-39", incolor: false, antireflexo: true, fotosensivel: false, blueCut: false, tipo: "PROGRESSIVAS ACABADAS", medidas: "ESF. 0,00/3,00 - AD: 1,00 a 3,00", espessura: "14mm", precoVista: "R$ 599,00", parcela3x: "R$ 239,60", parcela6x: "R$ 134,78", parcela10x: "R$ 98,84"},
            {id: 39, nome: "MF CR-39 - SHINEDUX", incolor: false, antireflexo: false, fotosensivel: false, blueCut: true, tipo: "PROGRESSIVAS ACABADAS", medidas: "ESF. 0,00/3,00 - AD: 1,00 a 3,00", espessura: "14mm", precoVista: "R$ 699,00", parcela3x: "R$ 279,60", parcela6x: "R$ 157,28", parcela10x: "R$ 115,33"},
            {id: 40, nome: "MF CR-39", incolor: false, antireflexo: false, fotosensivel: true, blueCut: false, tipo: "PROGRESSIVAS ACABADAS", medidas: "ESF. 0,00/3,00 - AD: 1,00 a 3,00", espessura: "14mm", precoVista: "R$ 599,00", parcela3x: "R$ 239,60", parcela6x: "R$ 134,78", parcela10x: "R$ 98,84"},
            {id: 41, nome: "MF CR-39 - SHINEDUX", incolor: false, antireflexo: true, fotosensivel: true, blueCut: false, tipo: "PROGRESSIVAS ACABADAS", medidas: "ESF. 0,00/3,00 - AD: 1,00 a 3,00", espessura: "14mm", precoVista: "R$ 699,00", parcela3x: "R$ 279,60", parcela6x: "R$ 157,28", parcela10x: "R$ 115,33"},
            {id: 42, nome: "MF CR39 - AUDAX", incolor: false, antireflexo: true, fotosensivel: true, blueCut: false, tipo: "PROGRESSIVAS ACABADAS", medidas: "ESF. 0,00/3,00 - AD: 1,00 a 3,00", espessura: "14mm", precoVista: "R$ 899,00", parcela3x: "R$ 359,60", parcela6x: "R$ 202,28", parcela10x: "R$ 148,33"},
            {id: 43, nome: "MF POLICARBONATO - SHINEDUX", incolor: false, antireflexo: false, fotosensivel: false, blueCut: true, tipo: "PROGRESSIVAS ACABADAS", medidas: "ESF. 0,00/2,00 - AD: 1,00 a 3,00", espessura: "14mm", precoVista: "R$ 1199,00", parcela3x: "R$ 479,60", parcela6x: "R$ 269,78", parcela10x: "R$ 197,83"}
        ];

        const questions = [
            {text: "Que tipo de visão?", key: "tipo", options: [
                {label: "VISÃO SIMPLES", value: "VISÃO SIMPLES"},
                {label: "LENTES SOLARES", value: "LENTES SOLARES"},
                {label: "BIFOCAIS", value: "BIFOCAIS CR-39"},
                {label: "PROGRESSIVAS", value: "PROGRESSIVAS ACABADAS"}
            ]},
            {text: "É incolor?", key: "incolor", options: [{label: "SIM", value: true}, {label: "NÃO", value: false}]},
            {text: "Tem antirreflexo?", key: "antireflexo", options: [{label: "SIM", value: true}, {label: "NÃO", value: false}]},
            {text: "É fotossensível?", key: "fotosensivel", options: [{label: "SIM", value: true}, {label: "NÃO", value: false}]},
            {text: "Tem blue cut?", key: "blueCut", options: [{label: "SIM", value: true}, {label: "NÃO", value: false}]}
        ];

        let currentQuestion = 0;
        let answers = {};

        // Carregar dados salvos
        function loadData() {
            const saved = localStorage.getItem('lensData');
            if (saved) lensData = JSON.parse(saved);
        }

        // Salvar dados
        function saveData() {
            localStorage.setItem('lensData', JSON.stringify(lensData));
        }

        // Mostrar tela
        function showScreen(screenId) {
            document.querySelectorAll('[id$="-screen"]').forEach(s => s.classList.add('hidden'));
            document.getElementById(screenId).classList.remove('hidden');
        }

        // Iniciar perguntas
        function startQuestions() {
            currentQuestion = 0;
            answers = {};
            showScreen('question-screen');
            showQuestion();
        }

        // Mostrar pergunta atual
        function showQuestion() {
            const q = questions[currentQuestion];
            document.getElementById('question-text').textContent = q.text;
            
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';

            const optionsDiv = document.getElementById('question-options');
            optionsDiv.innerHTML = '';
            
            q.options.forEach(option => {
                const btn = document.createElement('button');
                btn.className = 'btn';
                btn.textContent = option.label;
                btn.onclick = () => answerQuestion(option.value);
                optionsDiv.appendChild(btn);
            });
        }

        // Responder pergunta
        function answerQuestion(answer) {
            const q = questions[currentQuestion];
            answers[q.key] = answer;
            
            currentQuestion++;
            if (currentQuestion < questions.length) {
                showQuestion();
            } else {
                showResults();
            }
        }

        // Voltar pergunta
        function goBack() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion();
            } else {
                showScreen('welcome-screen');
            }
        }

        // Função para calcular valor total das parcelas
        function calculateTotal(parcelaValue, numParcelas) {
            const value = parseFloat(parcelaValue.replace('R$', '').replace(',', '.').trim());
            const total = value * numParcelas;
            return `R$ ${total.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
        }

        // Mostrar resultados
        function showResults() {
            const filtered = lensData.filter(lens => {
                return Object.keys(answers).every(key => lens[key] === answers[key]);
            });

            const resultsDiv = document.getElementById('results-list');
            resultsDiv.innerHTML = '';

            if (filtered.length === 0) {
                resultsDiv.innerHTML = '<p style="text-align: center;">Nenhuma lente encontrada com essas características.</p>';
            } else {
                filtered.forEach(lens => {
                    const card = document.createElement('div');
                    card.className = 'lens-card';
                    
                    const features = [];
                    if (lens.incolor) features.push('Incolor');
                    if (lens.antireflexo) features.push('Antirreflexo');
                    if (lens.fotosensivel) features.push('Fotossensível');
                    if (lens.blueCut) features.push('Blue Cut');

                    const total3x = calculateTotal(lens.parcela3x, 3);
                    const total6x = calculateTotal(lens.parcela6x, 6);
                    const total10x = calculateTotal(lens.parcela10x, 10);

                    card.innerHTML = `
                        <h3>${lens.nome}</h3>
                        ${lens.tipo ? `<div style="margin: 10px 0;"><span style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold;">${lens.tipo}</span></div>` : ''}
                        <div class="features">
                            ${features.map(f => `<span class="feature">${f}</span>`).join('')}
                        </div>
                        <p><small>${lens.medidas} - ${lens.espessura}</small></p>
                        <div class="price">${lens.precoVista}</div>
                        <div style="margin: 15px 0; font-size: 14px;">
                            <div style="margin: 8px 0; display: flex; justify-content: space-between; align-items: center;">
                                <span>3x de ${lens.parcela3x}</span>
                                <span style="color: #63b3ed; font-weight: bold;">Total: ${total3x}</span>
                            </div>
                            <div style="margin: 8px 0; display: flex; justify-content: space-between; align-items: center;">
                                <span>6x de ${lens.parcela6x}</span>
                                <span style="color: #63b3ed; font-weight: bold;">Total: ${total6x}</span>
                            </div>
                            <div style="margin: 8px 0; display: flex; justify-content: space-between; align-items: center;">
                                <span>10x de ${lens.parcela10x}</span>
                                <span style="color: #63b3ed; font-weight: bold;">Total: ${total10x}</span>
                            </div>
                        </div>
                        <p style="font-size: 11px; opacity: 0.7; margin-top: 8px; text-align: center;">
                            💰 Valor à vista: <strong>${lens.precoVista}</strong>
                        </p>
                    `;
                    resultsDiv.appendChild(card);
                });
            }

            showScreen('results-screen');
        }

        // Mostrar editor
        function showEditor() {
            renderLensList();
            showScreen('editor-screen');
        }

        // Ranges pré-definidos para facilitar edição
        const esfRanges = [
            "Esf. -15,00 a -12,25", "Esf. -12,00 a -10,25", "Esf. -10,00 a -8,25", "Esf. -8,00 a -6,25",
            "Esf. -6,00 a -4,25", "Esf. -4,00 a -2,25", "Esf. -2,00 a 0,00", "Esf. 0,00 a +2,00",
            "Esf. +2,25 a +4,00", "Esf. +4,25 a +6,00", "Esf. +6,25 a +8,00", "CURVA 600", "CURVA 800",
            "ESF. 0,00/2,00 - AD: 1,00 a 3,00", "ESF. 0,00/3,00 - AD: 1,00 a 3,00"
        ];

        const cilRanges = [
            "Cil. -0,25 a -2,00", "Cil. -2,25 a -4,00", "Cil. -4,25 a -6,00", "Cil. -0,25 a -3,00",
            "Cil. -0,25 a -4,00", "Cil. -2,00", "Cil. -3,00", "Cil. -4,00"
        ];

        const espessuras = ["1.50", "1.53", "1.56", "1.59", "1.61", "1.67", "1.74", "14mm", "15mm", "18mm", "70mm"];

        // Renderizar lista de lentes no editor
        function renderLensList() {
            const listDiv = document.getElementById('lens-list');
            listDiv.innerHTML = '';

            lensData.forEach((lens, index) => {
                const card = document.createElement('div');
                card.className = 'lens-card';
                card.innerHTML = `
                    <input class="editor-input" value="${lens.nome}" onchange="updateLens(${index}, 'nome', this.value)" placeholder="Nome">
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0;">
                        <label><input type="checkbox" ${lens.incolor ? 'checked' : ''} onchange="updateLens(${index}, 'incolor', this.checked)"> Incolor</label>
                        <label><input type="checkbox" ${lens.antireflexo ? 'checked' : ''} onchange="updateLens(${index}, 'antireflexo', this.checked)"> Antirreflexo</label>
                        <label><input type="checkbox" ${lens.fotosensivel ? 'checked' : ''} onchange="updateLens(${index}, 'fotosensivel', this.checked)"> Fotossensível</label>
                        <label><input type="checkbox" ${lens.blueCut ? 'checked' : ''} onchange="updateLens(${index}, 'blueCut', this.checked)"> Blue Cut</label>
                    </div>

                    <label style="font-size: 12px; color: #63b3ed; margin-top: 10px;">Medidas:</label>
                    <textarea class="editor-input" rows="2" onchange="updateLens(${index}, 'medidas', this.value)" placeholder="Ex: Esf. -6,00 a +4,00 / Cil. -0,25 a -2,00">${lens.medidas}</textarea>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 5px 0;">
                        <button class="btn-outline" style="font-size: 10px; padding: 5px;" onclick="showMedidasHelper(${index})">Ajuda Medidas</button>
                        <select class="editor-input" style="padding: 5px;" onchange="updateLens(${index}, 'espessura', this.value)">
                            ${espessuras.map(esp => `<option value="${esp}" ${lens.espessura === esp ? 'selected' : ''}>${esp}</option>`).join('')}
                        </select>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0;">
                        <input class="editor-input" value="${lens.precoVista}" onchange="updateLens(${index}, 'precoVista', this.value)" placeholder="Preço à Vista">
                        <input class="editor-input" value="${lens.parcela3x}" onchange="updateLens(${index}, 'parcela3x', this.value)" placeholder="3x">
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0;">
                        <input class="editor-input" value="${lens.parcela6x}" onchange="updateLens(${index}, 'parcela6x', this.value)" placeholder="6x">
                        <input class="editor-input" value="${lens.parcela10x}" onchange="updateLens(${index}, 'parcela10x', this.value)" placeholder="10x">
                    </div>

                    <button class="btn-outline btn" onclick="removeLens(${index})" style="margin-top: 10px;">Remover</button>
                `;
                listDiv.appendChild(card);
            });
        }

        // Mostrar helper para medidas
        function showMedidasHelper(index) {
            const helpText = `
Exemplos de medidas comuns:

LENTES DE GRAU:
• Esf. -6,00 a +4,00 / Cil. -0,25 a -2,00
• Esf. -4,00 a +4,00 / Cil. -2,25 a -4,00
• Esf. -10,00 a +6,00 / Cil. -0,25 a -4,00

LENTES COLORIDAS:
• CURVA 600
• CURVA 800
• CURVA 600 / 800

LENTES MULTIFOCAIS:
• ESF. 0,00/2,00 - AD: 1,00 a 3,00
• ESF. 0,00/3,00 - AD: 1,00 a 3,00

Clique em uma opção para usar:`;

            if (confirm(helpText + "\n\nVer exemplos específicos?")) {
                const medidaEscolhida = prompt(`Escolha uma medida:
1. Esf. -6,00 a +4,00 / Cil. -0,25 a -2,00
2. Esf. -4,00 a +4,00 / Cil. -2,25 a -4,00
3. CURVA 600
4. ESF. 0,00/3,00 - AD: 1,00 a 3,00
5. Personalizada

Digite o número ou a medida customizada:`);

                let novaMedida = '';
                switch(medidaEscolhida) {
                    case '1': novaMedida = 'Esf. -6,00 a +4,00 / Cil. -0,25 a -2,00'; break;
                    case '2': novaMedida = 'Esf. -4,00 a +4,00 / Cil. -2,25 a -4,00'; break;
                    case '3': novaMedida = 'CURVA 600'; break;
                    case '4': novaMedida = 'ESF. 0,00/3,00 - AD: 1,00 a 3,00'; break;
                    default: novaMedida = medidaEscolhida || lensData[index].medidas;
                }

                updateLens(index, 'medidas', novaMedida);
                renderLensList();
            }
        }

        // Atualizar lente
        function updateLens(index, field, value) {
            lensData[index][field] = value;
            saveData();
        }

        // Remover lente
        function removeLens(index) {
            lensData.splice(index, 1);
            saveData();
            renderLensList();
        }

        // Adicionar nova lente
        function addNewLens() {
            const newId = Math.max(...lensData.map(l => l.id)) + 1;
            lensData.push({
                id: newId,
                nome: "Nova Lente",
                incolor: false,
                antireflexo: false,
                fotosensivel: false,
                blueCut: false,
                medidas: "Esf. 0,00 / Cil. 0,00",
                espessura: "1.50",
                precoVista: "R$ 0,00",
                parcela3x: "R$ 0,00",
                parcela6x: "R$ 0,00",
                parcela10x: "R$ 0,00"
            });
            saveData();
            renderLensList();
        }

        // Mostrar todas as lentes
        function showAllLenses() {
            currentAnswers = {};
            currentStep = 0;
            showResults(lensData);
        }

        // Voltar para início
        function startOver() {
            showScreen('welcome-screen');
        }

        function backToWelcome() {
            showScreen('welcome-screen');
        }

        // Download da versão standalone
        function downloadStandalone() {
            const content = document.documentElement.outerHTML;
            const blob = new Blob([content], {type: 'text/html'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'configurador-oculos-offline.html';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Inicializar
        loadData();
    </script>
</body>
</html>